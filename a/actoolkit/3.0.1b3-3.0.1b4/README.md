# Comparing `tmp/actoolkit-3.0.1b3-py3-none-any.whl.zip` & `tmp/actoolkit-3.0.1b4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,56 +1,56 @@
-Zip file size: 123982 bytes, number of entries: 54
--rw-r--r--  2.0 unx    10104 b- defN 24-Apr-23 16:00 toolkit.py
--rw-r--r--  2.0 unx     1139 b- defN 24-Apr-23 16:00 astraSDK/__init__.py
--rw-r--r--  2.0 unx     3659 b- defN 24-Apr-23 16:00 astraSDK/apiresources.py
--rw-r--r--  2.0 unx    16993 b- defN 24-Apr-23 16:00 astraSDK/apps.py
--rw-r--r--  2.0 unx     8289 b- defN 24-Apr-23 16:00 astraSDK/backups.py
--rw-r--r--  2.0 unx     7355 b- defN 24-Apr-23 16:00 astraSDK/buckets.py
--rw-r--r--  2.0 unx     6972 b- defN 24-Apr-23 16:00 astraSDK/clouds.py
--rw-r--r--  2.0 unx    10776 b- defN 24-Apr-23 16:00 astraSDK/clusters.py
--rw-r--r--  2.0 unx    14439 b- defN 24-Apr-23 16:00 astraSDK/common.py
--rw-r--r--  2.0 unx     9115 b- defN 24-Apr-23 16:00 astraSDK/credentials.py
--rw-r--r--  2.0 unx     2663 b- defN 24-Apr-23 16:00 astraSDK/entitlements.py
--rw-r--r--  2.0 unx     7958 b- defN 24-Apr-23 16:00 astraSDK/groups.py
--rw-r--r--  2.0 unx     7162 b- defN 24-Apr-23 16:00 astraSDK/hooks.py
--rw-r--r--  2.0 unx    45273 b- defN 24-Apr-23 16:00 astraSDK/k8s.py
--rw-r--r--  2.0 unx     5458 b- defN 24-Apr-23 16:00 astraSDK/namespaces.py
--rw-r--r--  2.0 unx     3576 b- defN 24-Apr-23 16:00 astraSDK/notifications.py
--rw-r--r--  2.0 unx     8803 b- defN 24-Apr-23 16:00 astraSDK/protections.py
--rw-r--r--  2.0 unx     9735 b- defN 24-Apr-23 16:00 astraSDK/replications.py
--rw-r--r--  2.0 unx     5757 b- defN 24-Apr-23 16:00 astraSDK/rolebindings.py
--rw-r--r--  2.0 unx     7090 b- defN 24-Apr-23 16:00 astraSDK/scripts.py
--rw-r--r--  2.0 unx     9821 b- defN 24-Apr-23 16:00 astraSDK/settings.py
--rw-r--r--  2.0 unx     7083 b- defN 24-Apr-23 16:00 astraSDK/snapshots.py
--rw-r--r--  2.0 unx     2434 b- defN 24-Apr-23 16:00 astraSDK/storagebackends.py
--rw-r--r--  2.0 unx     5023 b- defN 24-Apr-23 16:00 astraSDK/storageclasses.py
--rw-r--r--  2.0 unx     9007 b- defN 24-Apr-23 16:00 astraSDK/users.py
--rw-r--r--  2.0 unx      883 b- defN 24-Apr-23 16:00 tkSrc/__init__.py
--rw-r--r--  2.0 unx    31513 b- defN 24-Apr-23 16:00 tkSrc/choices.py
--rw-r--r--  2.0 unx     3962 b- defN 24-Apr-23 16:00 tkSrc/classes.py
--rw-r--r--  2.0 unx    24645 b- defN 24-Apr-23 16:00 tkSrc/clone.py
--rw-r--r--  2.0 unx     2011 b- defN 24-Apr-23 16:00 tkSrc/copy.py
--rw-r--r--  2.0 unx    29616 b- defN 24-Apr-23 16:00 tkSrc/create.py
--rw-r--r--  2.0 unx    10646 b- defN 24-Apr-23 16:00 tkSrc/deploy.py
--rw-r--r--  2.0 unx     9791 b- defN 24-Apr-23 16:00 tkSrc/destroy.py
--rw-r--r--  2.0 unx    26842 b- defN 24-Apr-23 16:00 tkSrc/helpers.py
--rw-r--r--  2.0 unx     4964 b- defN 24-Apr-23 16:00 tkSrc/ipr.py
--rw-r--r--  2.0 unx    19364 b- defN 24-Apr-23 16:00 tkSrc/list.py
--rw-r--r--  2.0 unx    17049 b- defN 24-Apr-23 16:00 tkSrc/manage.py
--rw-r--r--  2.0 unx    79300 b- defN 24-Apr-23 16:00 tkSrc/parser.py
--rw-r--r--  2.0 unx     7187 b- defN 24-Apr-23 16:00 tkSrc/unmanage.py
--rw-r--r--  2.0 unx    10304 b- defN 24-Apr-23 16:00 tkSrc/update.py
--rw-r--r--  2.0 unx      446 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/app.jinja
--rw-r--r--  2.0 unx      532 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/appVault.jinja
--rw-r--r--  2.0 unx      406 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/backup.jinja
--rw-r--r--  2.0 unx      374 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/hook.jinja
--rw-r--r--  2.0 unx      277 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/ipr.jinja
--rw-r--r--  2.0 unx      417 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/protection.jinja
--rw-r--r--  2.0 unx      584 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/restore.jinja
--rw-r--r--  2.0 unx      533 b- defN 24-Apr-23 16:00 tkSrc/templates/jinja/snapshot.jinja
--rw-r--r--  2.0 unx    11357 b- defN 24-Apr-23 16:00 actoolkit-3.0.1b3.dist-info/LICENSE
--rw-r--r--  2.0 unx     9193 b- defN 24-Apr-23 16:00 actoolkit-3.0.1b3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-23 16:00 actoolkit-3.0.1b3.dist-info/WHEEL
--rw-r--r--  2.0 unx       43 b- defN 24-Apr-23 16:00 actoolkit-3.0.1b3.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       23 b- defN 24-Apr-23 16:00 actoolkit-3.0.1b3.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4254 b- defN 24-Apr-23 16:00 actoolkit-3.0.1b3.dist-info/RECORD
-54 files, 532292 bytes uncompressed, 117396 bytes compressed:  77.9%
+Zip file size: 124736 bytes, number of entries: 54
+-rw-r--r--  2.0 unx    10160 b- defN 24-Apr-26 20:26 toolkit.py
+-rw-r--r--  2.0 unx     1139 b- defN 24-Apr-26 20:26 astraSDK/__init__.py
+-rw-r--r--  2.0 unx     3659 b- defN 24-Apr-26 20:26 astraSDK/apiresources.py
+-rw-r--r--  2.0 unx    16993 b- defN 24-Apr-26 20:26 astraSDK/apps.py
+-rw-r--r--  2.0 unx     8289 b- defN 24-Apr-26 20:26 astraSDK/backups.py
+-rw-r--r--  2.0 unx     7355 b- defN 24-Apr-26 20:26 astraSDK/buckets.py
+-rw-r--r--  2.0 unx     6972 b- defN 24-Apr-26 20:26 astraSDK/clouds.py
+-rw-r--r--  2.0 unx    10776 b- defN 24-Apr-26 20:26 astraSDK/clusters.py
+-rw-r--r--  2.0 unx    14439 b- defN 24-Apr-26 20:26 astraSDK/common.py
+-rw-r--r--  2.0 unx     9115 b- defN 24-Apr-26 20:26 astraSDK/credentials.py
+-rw-r--r--  2.0 unx     2663 b- defN 24-Apr-26 20:26 astraSDK/entitlements.py
+-rw-r--r--  2.0 unx     7958 b- defN 24-Apr-26 20:26 astraSDK/groups.py
+-rw-r--r--  2.0 unx     7162 b- defN 24-Apr-26 20:26 astraSDK/hooks.py
+-rw-r--r--  2.0 unx    45273 b- defN 24-Apr-26 20:26 astraSDK/k8s.py
+-rw-r--r--  2.0 unx     5458 b- defN 24-Apr-26 20:26 astraSDK/namespaces.py
+-rw-r--r--  2.0 unx     3576 b- defN 24-Apr-26 20:26 astraSDK/notifications.py
+-rw-r--r--  2.0 unx    10989 b- defN 24-Apr-26 20:26 astraSDK/protections.py
+-rw-r--r--  2.0 unx     9735 b- defN 24-Apr-26 20:26 astraSDK/replications.py
+-rw-r--r--  2.0 unx     5757 b- defN 24-Apr-26 20:26 astraSDK/rolebindings.py
+-rw-r--r--  2.0 unx     7090 b- defN 24-Apr-26 20:26 astraSDK/scripts.py
+-rw-r--r--  2.0 unx     9821 b- defN 24-Apr-26 20:26 astraSDK/settings.py
+-rw-r--r--  2.0 unx     7083 b- defN 24-Apr-26 20:26 astraSDK/snapshots.py
+-rw-r--r--  2.0 unx     2434 b- defN 24-Apr-26 20:26 astraSDK/storagebackends.py
+-rw-r--r--  2.0 unx     5023 b- defN 24-Apr-26 20:26 astraSDK/storageclasses.py
+-rw-r--r--  2.0 unx     9007 b- defN 24-Apr-26 20:26 astraSDK/users.py
+-rw-r--r--  2.0 unx      883 b- defN 24-Apr-26 20:26 tkSrc/__init__.py
+-rw-r--r--  2.0 unx    32031 b- defN 24-Apr-26 20:26 tkSrc/choices.py
+-rw-r--r--  2.0 unx     3962 b- defN 24-Apr-26 20:26 tkSrc/classes.py
+-rw-r--r--  2.0 unx    24645 b- defN 24-Apr-26 20:26 tkSrc/clone.py
+-rw-r--r--  2.0 unx     2011 b- defN 24-Apr-26 20:26 tkSrc/copy.py
+-rw-r--r--  2.0 unx    30083 b- defN 24-Apr-26 20:26 tkSrc/create.py
+-rw-r--r--  2.0 unx    11071 b- defN 24-Apr-26 20:26 tkSrc/deploy.py
+-rw-r--r--  2.0 unx     9791 b- defN 24-Apr-26 20:26 tkSrc/destroy.py
+-rw-r--r--  2.0 unx    26842 b- defN 24-Apr-26 20:26 tkSrc/helpers.py
+-rw-r--r--  2.0 unx     4964 b- defN 24-Apr-26 20:26 tkSrc/ipr.py
+-rw-r--r--  2.0 unx    19364 b- defN 24-Apr-26 20:26 tkSrc/list.py
+-rw-r--r--  2.0 unx    17049 b- defN 24-Apr-26 20:26 tkSrc/manage.py
+-rw-r--r--  2.0 unx    81156 b- defN 24-Apr-26 20:26 tkSrc/parser.py
+-rw-r--r--  2.0 unx     7187 b- defN 24-Apr-26 20:26 tkSrc/unmanage.py
+-rw-r--r--  2.0 unx    12238 b- defN 24-Apr-26 20:26 tkSrc/update.py
+-rw-r--r--  2.0 unx      446 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/app.jinja
+-rw-r--r--  2.0 unx      532 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/appVault.jinja
+-rw-r--r--  2.0 unx      406 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/backup.jinja
+-rw-r--r--  2.0 unx      374 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/hook.jinja
+-rw-r--r--  2.0 unx      277 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/ipr.jinja
+-rw-r--r--  2.0 unx      417 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/protection.jinja
+-rw-r--r--  2.0 unx      584 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/restore.jinja
+-rw-r--r--  2.0 unx      533 b- defN 24-Apr-26 20:26 tkSrc/templates/jinja/snapshot.jinja
+-rw-r--r--  2.0 unx    11357 b- defN 24-Apr-26 20:26 actoolkit-3.0.1b4.dist-info/LICENSE
+-rw-r--r--  2.0 unx     9193 b- defN 24-Apr-26 20:26 actoolkit-3.0.1b4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-26 20:26 actoolkit-3.0.1b4.dist-info/WHEEL
+-rw-r--r--  2.0 unx       43 b- defN 24-Apr-26 20:26 actoolkit-3.0.1b4.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       23 b- defN 24-Apr-26 20:26 actoolkit-3.0.1b4.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4255 b- defN 24-Apr-26 20:26 actoolkit-3.0.1b4.dist-info/RECORD
+54 files, 539735 bytes uncompressed, 118150 bytes compressed:  78.1%
```

## zipnote {}

```diff
@@ -138,26 +138,26 @@
 
 Filename: tkSrc/templates/jinja/restore.jinja
 Comment: 
 
 Filename: tkSrc/templates/jinja/snapshot.jinja
 Comment: 
 
-Filename: actoolkit-3.0.1b3.dist-info/LICENSE
+Filename: actoolkit-3.0.1b4.dist-info/LICENSE
 Comment: 
 
-Filename: actoolkit-3.0.1b3.dist-info/METADATA
+Filename: actoolkit-3.0.1b4.dist-info/METADATA
 Comment: 
 
-Filename: actoolkit-3.0.1b3.dist-info/WHEEL
+Filename: actoolkit-3.0.1b4.dist-info/WHEEL
 Comment: 
 
-Filename: actoolkit-3.0.1b3.dist-info/entry_points.txt
+Filename: actoolkit-3.0.1b4.dist-info/entry_points.txt
 Comment: 
 
-Filename: actoolkit-3.0.1b3.dist-info/top_level.txt
+Filename: actoolkit-3.0.1b4.dist-info/top_level.txt
 Comment: 
 
-Filename: actoolkit-3.0.1b3.dist-info/RECORD
+Filename: actoolkit-3.0.1b4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## toolkit.py

```diff
@@ -245,8 +245,11 @@
     elif args.subcommand == "unmanage":
         tkSrc.unmanage.main(args, parser, ard)
     elif args.subcommand == "update":
         tkSrc.update.main(args, parser, ard)
 
 
 if __name__ == "__main__":
-    main()
+    try:
+        main()
+    except KeyboardInterrupt:
+        pass
```

## astraSDK/protections.py

```diff
@@ -176,14 +176,15 @@
         snapshotRetention,
         dayOfWeek,
         dayOfMonth,
         hour,
         minute,
         appID,
         recurrenceRule=None,
+        bucketID=None,
     ):
         endpoint = f"k8s/v1/apps/{appID}/schedules"
         url = self.base + endpoint
         params = {}
         data = {
             "type": "application/astra-schedule",
             "version": "1.2",
@@ -196,24 +197,96 @@
             "minute": minute,
             "name": f"{granularity} schedule",
             "snapshotRetention": snapshotRetention,
         }
         if recurrenceRule:
             data["recurrenceRule"] = recurrenceRule
             data["replicate"] = "true"
+        if bucketID:
+            data["bucketID"] = bucketID
 
         ret = super().apicall(
             "post",
             url,
             data,
             self.headers,
             params,
             self.verifySSL,
             quiet=self.quiet,
             verbose=self.verbose,
+        )
+
+        if ret.ok:
+            results = super().jsonifyResults(ret)
+            if not self.quiet:
+                print(json.dumps(results))
+            return results
+        else:
+            if not self.quiet:
+                super().printError(ret)
+            return False
+
+
+class updateProtectionpolicy(SDKCommon):
+    """Update a protection policy. This class does no validation of the arguments, leaving
+    that to the API call itself. tkSrc/update.py can be used as a guide as to what the API
+    requirements are in case the swagger isn't sufficient.
+    """
+
+    def __init__(self, quiet=True, verbose=False):
+        """quiet: Will there be CLI output or just return (datastructure)
+        verbose: Print all of the ReST call info: URL, Method, Headers, Request Body"""
+        self.quiet = quiet
+        self.verbose = verbose
+        super().__init__()
+        self.headers["Content-Type"] = "application/astra-schedule+json"
+
+    def main(
+        self,
+        appID,
+        protectionID,
+        granularity,
+        backupRetention,
+        snapshotRetention,
+        minute=None,
+        hour=None,
+        dayOfWeek=None,
+        dayOfMonth=None,
+        bucketID=None,
+    ):
+        endpoint = f"k8s/v1/apps/{appID}/schedules/{protectionID}"
+        url = self.base + endpoint
+        params = {}
+        data = {
+            "type": "application/astra-schedule",
+            "version": "1.3",
+            "granularity": granularity,
+            "backupRetention": backupRetention,
+            "snapshotRetention": snapshotRetention,
+        }
+        if minute:
+            data["minute"] = minute
+        if hour:
+            data["hour"] = hour
+        if dayOfWeek:
+            data["dayOfWeek"] = dayOfWeek
+        if dayOfMonth:
+            data["dayOfMonth"] = dayOfMonth
+        if bucketID:
+            data["bucketID"] = bucketID
+
+        ret = super().apicall(
+            "put",
+            url,
+            data,
+            self.headers,
+            params,
+            self.verifySSL,
+            quiet=self.quiet,
+            verbose=self.verbose,
         )
 
         if ret.ok:
             results = super().jsonifyResults(ret)
             if not self.quiet:
                 print(json.dumps(results))
             return results
```

## tkSrc/choices.py

```diff
@@ -187,14 +187,17 @@
                     acl.scripts = ard.buildList("scripts", "id")
             if argv[verbPosition + 1] == "protection" or argv[verbPosition + 1] == "schedule":
                 if v3:
                     ard.buckets = astraSDK.k8s.getResources(
                         config_context=v3, skip_tls_verify=v3_skip_tls_verify
                     ).main("appvaults")
                     acl.buckets = ard.buildList("buckets", "metadata.name")
+                else:
+                    ard.buckets = astraSDK.buckets.getBuckets().main()
+                    acl.buckets = ard.buildList("buckets", "id")
             if argv[verbPosition + 1] == "replication":
                 ard.destClusters = astraSDK.clusters.getClusters().main(hideUnmanaged=True)
                 acl.destClusters = ard.buildList("destClusters", "id")
                 ard.storageClasses = astraSDK.storageclasses.getStorageClasses(quiet=True).main()
                 acl.storageClasses = ard.buildList("storageClasses", "name")
                 acl.storageClasses = list(set(acl.storageClasses))
         elif argv[verbPosition + 1] == "cluster":
@@ -466,15 +469,15 @@
                 ard.clusters = astraSDK.clusters.getClusters().main()
                 acl.clusters = ard.buildList("clusters", "id", fKey="managedState", fVal="managed")
         elif argv[verbPosition + 1] == "cloud":
             ard.clouds = astraSDK.clouds.getClouds().main()
             acl.clouds = ard.buildList("clouds", "id")
 
     elif verbs["update"] and len(argv) - verbPosition >= 2:
-        if argv[verbPosition + 1] == "bucket":
+        if argv[verbPosition + 1] == "bucket" or argv[verbPosition + 1] == "appVault":
             ard.buckets = astraSDK.buckets.getBuckets().main()
             acl.buckets = ard.buildList("buckets", "id")
             ard.credentials = astraSDK.credentials.getCredentials().main()
             for credential in ard.credentials["items"]:
                 if credential["metadata"].get("labels"):
                     credID = None
                     if credential.get("keyType") == "s3":
@@ -509,14 +512,19 @@
             acl.buckets = ard.buildList("buckets", "id")
             ard.clusters = astraSDK.clusters.getClusters().main()
             # If we're updating a default bucket, only allow managed clusters
             if len(set(argv[verbPosition + 2 :]) & set(acl.buckets)) > 0:
                 acl.clusters = ard.buildList("clusters", "id", fKey="managedState", fVal="managed")
             else:
                 acl.clusters = ard.buildList("clusters", "id")
+        elif argv[verbPosition + 1] == "protection":
+            ard.protections = astraSDK.protections.getProtectionpolicies().main()
+            acl.protections = ard.buildList("protections", "id")
+            ard.buckets = astraSDK.buckets.getBuckets().main()
+            acl.buckets = ard.buildList("buckets", "id")
         elif argv[verbPosition + 1] == "replication":
             ard.replications = astraSDK.replications.getReplicationpolicies().main()
             if not ard.replications:  # Gracefully handle ACS env
                 raise SystemExit(
                     "Error: 'replication' commands are currently only supported in ACC."
                 )
             acl.replications = ard.buildList("replications", "id")
```

## tkSrc/create.py

```diff
@@ -337,15 +337,15 @@
     dayOfWeek,
     dayOfMonth,
 ):
     """Create a protection policy via a Kubernetes custom resource"""
     template = helpers.setupJinja("protection")
     v3_dict = yaml.safe_load(
         template.render(
-            name=helpers.isRFC1123(f"{app}-{granularity}", ignore_length=True) + "-",
+            name=helpers.isRFC1123(f"{granularity}-{app}", ignore_length=True) + "-",
             appName=app,
             appVaultName=bucket,
             backupRetention=backupRetention,
             dayOfMonth=dayOfMonth,
             dayOfWeek=dayOfWeek,
             granularity=granularity,
             hour=hour,
@@ -436,15 +436,15 @@
                 args.verbose,
                 args.name,
                 args.app,
                 args.bucket,
                 args.snapshot,
                 args.reclaimPolicy,
             )
-            if not args.dry_run and not args.background:
+            if backup and not args.dry_run and not args.background:
                 monitorV3ProtectionTask(
                     backup, args.pollTimer, parser, args.v3, args.skip_tls_verify
                 )
         else:
             protectionID = astraSDK.backups.takeBackup(quiet=args.quiet, verbose=args.verbose).main(
                 args.app,
                 helpers.isRFC1123(args.name, parser=parser),
@@ -584,14 +584,22 @@
                 parser.error("'monthly' granularity requires -H / --hour")
             if args.dayOfWeek:
                 parser.error("'monthly' granularity must not specify -W / --dayOfWeek")
             if not args.dayOfMonth:
                 parser.error("'monthly' granularity requires -M / --dayOfMonth")
             args.dayOfWeek = naStr
         if args.v3:
+            if ard.needsattr("buckets"):
+                ard.buckets = astraSDK.k8s.getResources(
+                    config_context=args.v3, skip_tls_verify=args.skip_tls_verify
+                ).main("appvaults")
+            if args.bucket is None:
+                args.bucket = ard.getSingleDict("buckets", "status.state", "available", parser)[
+                    "metadata"
+                ]["name"]
             createV3Protection(
                 args.v3,
                 args.dry_run,
                 args.skip_tls_verify,
                 args.quiet,
                 args.verbose,
                 args.app,
@@ -612,14 +620,15 @@
                 str(args.backupRetention),
                 str(args.snapshotRetention),
                 str(args.dayOfWeek),
                 str(args.dayOfMonth),
                 str(args.hour),
                 str(args.minute),
                 args.app,
+                bucketID=args.bucket,
             )
             if rc is False:
                 raise SystemExit("astraSDK.protections.createProtectionpolicy() failed")
     elif args.objectType == "replication":
         # Validate offset values and create DTSTART string
         if ":" in args.offset:
             hours = args.offset.split(":")[0].zfill(2)
@@ -705,15 +714,15 @@
                 args.name,
                 args.app,
                 args.bucket,
                 reclaimPolicy=args.reclaimPolicy,
                 createdTimeout=args.createdTimeout,
                 readyToUseTimeout=args.readyToUseTimeout,
             )
-            if not args.dry_run and not args.background:
+            if snapshot and not args.dry_run and not args.background:
                 monitorV3ProtectionTask(
                     snapshot, args.pollTimer, parser, args.v3, args.skip_tls_verify
                 )
         else:
             protectionID = astraSDK.snapshots.takeSnap(quiet=args.quiet, verbose=args.verbose).main(
                 args.app,
                 helpers.isRFC1123(args.name, parser=parser),
```

## tkSrc/deploy.py

```diff
@@ -250,14 +250,23 @@
             parser.error(
                 "'deploy acp' is currently only supported as a --v3 command, please re-run with "
                 "--v3 and an optional context, kubeconfig_file, or context@kubeconfig_file mapping"
             )
     elif args.objectType == "chart":
         if not hasattr(args, "bucket"):
             args.bucket = None
+        if args.v3:
+            if ard.needsattr("buckets"):
+                ard.buckets = astraSDK.k8s.getResources(
+                    config_context=args.v3, skip_tls_verify=args.skip_tls_verify
+                ).main("appvaults")
+            if args.bucket is None:
+                args.bucket = ard.getSingleDict("buckets", "status.state", "available", parser)[
+                    "metadata"
+                ]["name"]
         deployHelm(
             args.chart,
             helpers.isRFC1123(args.app, parser=parser),
             args.namespace,
             args.set,
             args.values,
             args.bucket,
```

## tkSrc/parser.py

```diff
@@ -442,24 +442,30 @@
             help="unmanage (disable) an LDAP(S) server",
         )
 
     def sub_update_commands(self):
         """update 'X'"""
         self.subparserUpdateBucket = self.subparserUpdate.add_parser(
             "bucket",
+            aliases=["appVault"],
             help="update bucket",
         )
         self.subparserUpdateCloud = self.subparserUpdate.add_parser(
             "cloud",
             help="update cloud",
         )
         self.subparserUpdateCluster = self.subparserUpdate.add_parser(
             "cluster",
             help="update cluster",
         )
+        self.subparserUpdateProtection = self.subparserUpdate.add_parser(
+            "protection",
+            aliases=["schedule"],
+            help="update protection policy",
+        )
         self.subparserUpdateReplication = self.subparserUpdate.add_parser(
             "replication",
             help="update replication",
         )
         self.subparserUpdateScript = self.subparserUpdate.add_parser(
             "script",
             help="update script",
@@ -708,15 +714,14 @@
         )
         if self.v3:
             self.subparserDeployChart.add_argument(
                 "-u",
                 "--appVault",
                 dest="bucket",
                 default=None,
-                required=True,
                 choices=(None if self.plaidMode else self.acl.buckets),
                 help="Name of the AppVault to use as the target of the backups/snapshots",
             )
         self.subparserDeployChart.add_argument(
             "-n",
             "--namespace",
             required=True,
@@ -1363,24 +1368,22 @@
     def create_protection_args(self):
         """create protection args and flags"""
         self.subparserCreateProtection.add_argument(
             "app",
             choices=(None if self.plaidMode else self.acl.apps),
             help="the application to create protection schedule for",
         )
-        if self.v3:
-            self.subparserCreateProtection.add_argument(
-                "-u",
-                "--appVault",
-                dest="bucket",
-                default=None,
-                required=True,
-                choices=(None if self.plaidMode else self.acl.buckets),
-                help="Name of the AppVault to use as the target of the backup/snapshot",
-            )
+        self.subparserCreateProtection.add_argument(
+            "-u",
+            "--appVault" if self.v3 else "--bucket",
+            dest="bucket",
+            default=None,
+            choices=(None if self.plaidMode else self.acl.buckets),
+            help="Name of the AppVault to use as the target of the backup/snapshot",
+        )
         self.subparserCreateProtection.add_argument(
             "-g",
             "--granularity",
             required=True,
             choices=["hourly", "daily", "weekly", "monthly"],
             help="Must choose one of the four options for the schedule",
         )
@@ -2017,14 +2020,60 @@
             "-b",
             "--defaultBucketID",
             choices=(None if self.plaidMode else self.acl.buckets),
             default=None,
             help="the new default bucket / appVault for the cluster",
         )
 
+    def update_protection_args(self):
+        """update protection args and flags"""
+        self.subparserUpdateProtection.add_argument(
+            "protection",
+            choices=(None if self.plaidMode else self.acl.protections),
+            help="protection to update",
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-u",
+            "--bucketID",
+            dest="bucket",
+            default=None,
+            choices=(None if self.plaidMode else self.acl.buckets),
+            help="the bucket to use as the target of the backup/snapshot",
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-b",
+            "--backupRetention",
+            type=int,
+            choices=range(60),
+            help="Number of backups to retain",
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-s",
+            "--snapshotRetention",
+            type=int,
+            choices=range(60),
+            help="Number of snapshots to retain",
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-M", "--dayOfMonth", type=int, choices=range(1, 32), help="Day of the month"
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-W",
+            "--dayOfWeek",
+            type=int,
+            choices=range(7),
+            help="0 = Sunday ... 6 = Saturday",
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-H", "--hour", type=int, choices=range(24), help="Hour in military time"
+        )
+        self.subparserUpdateProtection.add_argument(
+            "-m", "--minute", default=0, type=int, choices=range(60), help="Minute"
+        )
+
     def update_replication_args(self):
         """update replication args and flags"""
         self.subparserUpdateReplication.add_argument(
             "replicationID",
             choices=(None if self.plaidMode else self.acl.replications),
             help="replicationID to update",
         )
@@ -2134,12 +2183,13 @@
         self.unmanage_app_args()
         self.unmanage_bucket_args()
         self.unmanage_cluster_args()
         self.unmanage_cloud_args()
 
         self.update_bucket_args()
         self.update_cloud_args()
+        self.update_cluster_args()
+        self.update_protection_args()
         self.update_replication_args()
         self.update_script_args()
-        self.update_cluster_args()
 
         return self.parser
```

## tkSrc/update.py

```diff
@@ -119,14 +119,47 @@
         if args.defaultBucketID:
             rc = astraSDK.clusters.updateCluster(quiet=args.quiet, verbose=args.verbose).main(
                 cluster.get("id"),
                 defaultBucketID=args.defaultBucketID,
             )
             if rc is False:
                 raise SystemExit("astraSDK.clusters.updateCluster() failed")
+    elif args.objectType == "protection" or args.objectType == "schedule":
+        if ard.needsattr("protections"):
+            ard.protections = astraSDK.protections.getProtectionpolicies().main()
+        protection = ard.getSingleDict("protections", "id", args.protection, parser)
+        granularity = protection["granularity"]
+        if granularity == "hourly" and args.hour:
+            parser.error(f"{granularity} granularity must not specify -H / --hour")
+        if granularity == "hourly" or granularity == "daily" or granularity == "monthly":
+            if args.dayOfWeek:
+                parser.error(f"{granularity} granularity must not specify -W / --dayOfWeek")
+        if granularity == "hourly" or granularity == "daily" or granularity == "weekly":
+            if args.dayOfMonth:
+                parser.error(f"{granularity} granularity must not specify -M / --dayOfMonth")
+        rc = astraSDK.protections.updateProtectionpolicy(
+            quiet=args.quiet, verbose=args.verbose
+        ).main(
+            protection["appID"],
+            protection["id"],
+            protection["granularity"],
+            str(args.backupRetention) if args.backupRetention else protection["backupRetention"],
+            (
+                str(args.snapshotRetention)
+                if args.snapshotRetention
+                else protection["snapshotRetention"]
+            ),
+            minute=str(args.minute) if args.minute else protection.get("minute"),
+            hour=str(args.hour) if args.hour else protection.get("hour"),
+            dayOfWeek=str(args.dayOfWeek) if args.dayOfWeek else protection.get("dayOfWeek"),
+            dayOfMonth=str(args.dayOfMonth) if args.dayOfMonth else protection.get("dayOfMonth"),
+            bucketID=args.bucket if args.bucket else protection.get("bucketID"),
+        )
+        if rc is False:
+            raise SystemExit("astraSDK.protection.updateProtectionpolicy() failed")
     elif args.objectType == "replication":
         # Gather replication data
         if ard.needsattr("replications"):
             ard.replications = astraSDK.replications.getReplicationpolicies().main()
             if not ard.replications:  # Gracefully handle ACS env
                 parser.error("'replication' commands are currently only supported in ACC.")
         repl = None
```

## Comparing `actoolkit-3.0.1b3.dist-info/LICENSE` & `actoolkit-3.0.1b4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `actoolkit-3.0.1b3.dist-info/METADATA` & `actoolkit-3.0.1b4.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: actoolkit
-Version: 3.0.1b3
+Version: 3.0.1b4
 Summary: Toolkit and SDK for interacting with Astra Control
 Home-page: https://github.com/NetApp/netapp-astra-toolkits
 Author: Michael Haigh
 Author-email: Michael.Haigh@netapp.com
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Operating System :: OS Independent
```

## Comparing `actoolkit-3.0.1b3.dist-info/RECORD` & `actoolkit-3.0.1b4.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-toolkit.py,sha256=Y8zQm4gxXQ-O8tbwoV1WlP8-Nw6jrpgnyL7hse5F-zY,10104
+toolkit.py,sha256=WETiKTr6PWUIoUvpKeXLzHAlC7MJ25hZRR3aCiv125o,10160
 astraSDK/__init__.py,sha256=9IogQObmUB6rrUv2B_MemA3XJI6BraZzfJn5ewLrGww,1139
 astraSDK/apiresources.py,sha256=rz_8JYN0qeY4y1K5H6OzI1HQmhQMqRgcUogY1d9HJhs,3659
 astraSDK/apps.py,sha256=HQ7ADBoj1pONiRBKMaroG3uL8m6kAIw6W-VzZqqCKBg,16993
 astraSDK/backups.py,sha256=wVk_kSInOcSniDYyty07T5yy2Mp1AmZz40G9saNRMSs,8289
 astraSDK/buckets.py,sha256=0dKsmhlg9VRxMIXCbamqDZZ5YuHJwhxWs3i-wJgED4E,7355
 astraSDK/clouds.py,sha256=qcE1r0WbU3v3JSIF17Jlbsnv81kLE0M_uI8xFwqV5s0,6972
 astraSDK/clusters.py,sha256=GIFDwGJBeXeYgMkNd5lFjmGZrDYWjrzqos9YYot5X2k,10776
@@ -10,45 +10,45 @@
 astraSDK/credentials.py,sha256=tmvbJ9YwiqUhP0WKcSIysRYSB9gkCwXyVhYeKXB8xiA,9115
 astraSDK/entitlements.py,sha256=cWfWWEG-3i1aZbpKxD9adNaIcY50Ezm5Ykszu_sfp2A,2663
 astraSDK/groups.py,sha256=YoGysVgQGkJLw7VKUZBdBx8lC1B-9rNFqvFhrKdVRCc,7958
 astraSDK/hooks.py,sha256=7ato-tpUjzm2p8EWybGLVRhKnqvEOJpdRVGIqUuxp0c,7162
 astraSDK/k8s.py,sha256=EWoqrt0DxTm5XAKUZ3KO1CfijF89Es0FpF7Vt8MwLpk,45273
 astraSDK/namespaces.py,sha256=NExkodJpRKHPbDlpAxcCcmp5vGaHV8JFrCXi02LQwFQ,5458
 astraSDK/notifications.py,sha256=cnurpqSBXwRL-vTNxp6SYAl-xz7qzJnLT6w8kwBo4r4,3576
-astraSDK/protections.py,sha256=qQSqm-uFBbO6TReLH-8hC0e5ZRFSBLmuhYxK8EZVdRE,8803
+astraSDK/protections.py,sha256=VdM475JgYtu1XmyS2lPKwPxCf5rl13faC99EXlZakFM,10989
 astraSDK/replications.py,sha256=1sFZtKDZ1k_0Y2f7V71ZZzoNP1vkR-3Xk8ESHB7j4gQ,9735
 astraSDK/rolebindings.py,sha256=C_fTyegWZ1XLaajIzI_ftybpkLEsPMnCmyn4mNn3g1M,5757
 astraSDK/scripts.py,sha256=AHMjcDhE5am8PhbUhALh7W22h2lSFe99qDRHTasGjtQ,7090
 astraSDK/settings.py,sha256=FjLCGalV_CVq_aQXixAPTe0GDCNYYV3NopLtVlk0_80,9821
 astraSDK/snapshots.py,sha256=P3FU7zUMnmAYmlorYp_qq1knU24Fa3VrymvS_Pn-hVg,7083
 astraSDK/storagebackends.py,sha256=U4xh-hv5P7ip69Je6e9HIqhGPusU0VukHmzugtUpk_o,2434
 astraSDK/storageclasses.py,sha256=YKMkLFqALreDcUPs1xQzzsadzLZPaLXmuwuJbKoMlXk,5023
 astraSDK/users.py,sha256=nuUS9llQ8I75XEjkRlWvFaai9Kg_VAIO9U7UK7xeKfo,9007
 tkSrc/__init__.py,sha256=bEBPw__Mr4AQFYM-nje4IiKl3_0ljSg_WvdfKItXS20,883
-tkSrc/choices.py,sha256=BCHpBsn75SnsF6Dn5guPfplo6gl6BS4NXPJvd-WX2pw,31513
+tkSrc/choices.py,sha256=E1jIQGVpIO0wgKNeECMItq-Mv0U_AP-YZM873onpQoA,32031
 tkSrc/classes.py,sha256=a7CZwV9WgT4eNytrPQiAtmR_EMUQH7N7OyW-EhIbGU0,3962
 tkSrc/clone.py,sha256=BEBC8-lFODegWluIkA3OoY8YVnaOwqZ2S8veyqARNjk,24645
 tkSrc/copy.py,sha256=sIiVt1gE4IJVJmwxXiHlhj-jKmYFrYSxdx3COSGG534,2011
-tkSrc/create.py,sha256=xeIc4LJtTJKyRvYNXuuhY4aiQzpmHpOvHv_gEcff2-Q,29616
-tkSrc/deploy.py,sha256=VDBMHvkVSPX1UU3yZqIh8MkLyqE0NPAy3E_vyd9xIbA,10646
+tkSrc/create.py,sha256=2md6C6xXu2KreaEokLW_hyrJdY_Mp-g_C9qkZCDmkC8,30083
+tkSrc/deploy.py,sha256=mwqv2wD9IuH4FU2kfiDYPgk_98HzDhp8jaroM-ryxE4,11071
 tkSrc/destroy.py,sha256=kBMvuLjTCKTgxnjG7P0lQaWdpGktMIYP5ElXqFClzMM,9791
 tkSrc/helpers.py,sha256=3npJ1jdtr6ycAqIuQf_6mvpibbmSlTdTYSdqDKeqR5s,26842
 tkSrc/ipr.py,sha256=fxJWqGVHCffaynh9udAq-7p262-XH55UstIU_yRSPLQ,4964
 tkSrc/list.py,sha256=qy43Uh-rdTFGnlBtGZpJfgTp3DYHcJim0WCBL1pkCEY,19364
 tkSrc/manage.py,sha256=UCkbzcFlTUpqDRIG7rzfTWmTEmMoSgwwmiEOL0f1_FQ,17049
-tkSrc/parser.py,sha256=c2oI6I8Rsiv8DrTZlGQV9TR3IzPfONR8QbhRD2eMaoM,79300
+tkSrc/parser.py,sha256=8I_QzdYBenHlOCudT2wwBSAvOOywWw6J8yWXuGk3Y40,81156
 tkSrc/unmanage.py,sha256=rrpHGXOQPBGYKkHUTTKMy8CnAMRhpBu_EzVEWionIo4,7187
-tkSrc/update.py,sha256=rUu9mkIsbHTUNtj0YeOxv0nP4fG8zx7s-jlLFNfxKzU,10304
+tkSrc/update.py,sha256=Yv9bTpwmqjk_J-9-qDbwcZKY_JRbkM0QuvFfHXLnkXs,12238
 tkSrc/templates/jinja/app.jinja,sha256=6hkzd1kb3M2NWv1fOHERBacuIZ6Y4f-ymJthwPWHaF8,446
 tkSrc/templates/jinja/appVault.jinja,sha256=pJccPuk1Co6oGvwqYwy0kHGoLGtrmKqLMewYLovSYcU,532
 tkSrc/templates/jinja/backup.jinja,sha256=0m1Z-plkxS8xIa8QgmnnR5eNaLxHQkM1EJwgTGKOPF0,406
 tkSrc/templates/jinja/hook.jinja,sha256=shg7mtmw-pxyQPvc1ApJBk9h1ra33X5zWY6QXVnemE0,374
 tkSrc/templates/jinja/ipr.jinja,sha256=o24Gd86lkZicpwrlRRxz2asvQBDzGGpv8q7XGeNKO9A,277
 tkSrc/templates/jinja/protection.jinja,sha256=W2kXOkrkSLoHuAJJY3RFesc0HF_LSyuJ5dFBBMiwE-U,417
 tkSrc/templates/jinja/restore.jinja,sha256=yofEKvIBF5dwBVbdjIlLBoMk99JR9h97HzUmBbYaNw0,584
 tkSrc/templates/jinja/snapshot.jinja,sha256=kyEShlXwosIr7jYbywD-VcuaezhI2HpXYvVDleC7KzU,533
-actoolkit-3.0.1b3.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-actoolkit-3.0.1b3.dist-info/METADATA,sha256=fZAq3SNYGrKG0PaSzka8c0E9-Xc3KUDDYQ-CMBxYsXQ,9193
-actoolkit-3.0.1b3.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-actoolkit-3.0.1b3.dist-info/entry_points.txt,sha256=MdrJm8ktNHa01CEY7q5irB9JDPT_qg6hVpZWUhbKXWU,43
-actoolkit-3.0.1b3.dist-info/top_level.txt,sha256=wWyEWMBpCvR7Kv5mt_hBl4SEOLoVTV_9blXZhzBu7Y8,23
-actoolkit-3.0.1b3.dist-info/RECORD,,
+actoolkit-3.0.1b4.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+actoolkit-3.0.1b4.dist-info/METADATA,sha256=tbiB91UCCkBxaLifJvrD9iSBCPczp_SSQnuKGdP1VwI,9193
+actoolkit-3.0.1b4.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+actoolkit-3.0.1b4.dist-info/entry_points.txt,sha256=MdrJm8ktNHa01CEY7q5irB9JDPT_qg6hVpZWUhbKXWU,43
+actoolkit-3.0.1b4.dist-info/top_level.txt,sha256=wWyEWMBpCvR7Kv5mt_hBl4SEOLoVTV_9blXZhzBu7Y8,23
+actoolkit-3.0.1b4.dist-info/RECORD,,
```

